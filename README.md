# Font Manager

SillyTavern용 고급 폰트 관리 확장 프로그램입니다. 다양한 폰트를 쉽게 관리하고 적용할 수 있도록 도와줍니다.

## 📋 목차

- [주요 기능](#주요-기능)
- [설치 방법](#설치-방법)
- [사용 방법](#사용-방법)
- [기능 설명](#기능-설명)
- [슬래시 커맨드](#슬래시-커맨드)
- [설정 파일](#설정-파일)
- [문제 해결](#문제-해결)
- [라이선스](#라이선스)

## 🎯 주요 기능

### ✨ 폰트 관리
- **UI 폰트**: 인터페이스 요소의 폰트 변경
- **메시지 폰트**: 채팅 메시지의 폰트 변경
- **다국어 폰트 지원**: 영어, 한국어, 일본어, 중국어별 개별 폰트 설정
- **커스텀 CSS 폰트**: @font-face 규칙을 통한 커스텀 폰트 추가

### 🎨 세밀한 조절
- 폰트 크기 조절 (10px ~ 25px)
- 폰트 굵기 조절 (webkit-text-stroke)
- 줄 간격 조절 (line-height)
- 입력창 전용 폰트 크기 설정

### 📦 프리셋 시스템
- 폰트 조합을 프리셋으로 저장
- 프리셋 간 빠른 전환
- 프리셋 이름 수정 및 삭제

### 🎭 테마 연동
- 테마별 자동 폰트 적용
- 테마 변경 시 자동 프리셋 전환
- 사용자 정의 테마 규칙 설정

### 💾 백업 및 복원
- **스마트 설정 내보내기**: 현재 선택된 프리셋 정보까지 함께 백업
- **충돌 없는 설정 병합**: 기존 설정과 충돌 없이 새로운 설정을 안전하게 병합
- **기존 파일 호환성**: 이전 버전의 백업 파일도 문제없이 불러오기 가능
- **다른 환경으로의 설정 이전 지원**: JSON 형태의 백업 파일

## 🚀 설치 방법

### 1. SillyTavern -> Extension 메뉴 -> Install extension -> Github 링크 입력

### 2. SillyTavern 재시작

확장을 설치한 후 SillyTavern을 재시작해주세요.

### 3. 확장 활성화

1. SillyTavern 실행
2. 좌측 하단의 요술봉 메뉴 (🪄) 클릭
3. "폰트 관리" 항목 확인

## 📖 사용 방법

### 기본 사용법

1. **폰트 매니저 열기**
   - 확장 메뉴에서 "폰트 관리" 클릭
   - 또는 슬래시 커맨드 `/font` 사용

2. **폰트 매니저 활성화**
   - "폰트 매니저 활성화" 체크박스 선택

3. **폰트 추가**
   - "폰트 가져오기" 섹션에 CSS @font-face 규칙 입력
   - "가져오기" 버튼 클릭
   - 폰트 이름 설정

4. **폰트 적용**
   - UI 폰트 또는 메시지 폰트 드롭다운에서 폰트 선택
   - 조절바를 사용하여 크기 및 굵기 조절

5. **설정 백업 (권장)**
   - 설정 완료 후 "설정 내보내기"로 백업 파일 생성
   - 현재 선택된 프리셋까지 함께 백업됨

### 폰트 추가 예시

```css
@font-face {
    font-family: 'Pretendard-Regular';
    src: url('https://fastly.jsdelivr.net/gh/Project-Noonnu/noonfonts_2107@1.1/Pretendard-Regular.woff') format('woff');
    font-weight: 400;
    font-style: normal;
}
```

## 🛠 기능 설명

### 프리셋 관리

- **저장**: 현재 폰트 설정을 프리셋으로 저장
- **수정**: 프리셋 이름 변경
- **삭제**: 불필요한 프리셋 제거
- **추가**: 새로운 빈 프리셋 생성

### 다국어 폰트

다국어 폰트를 활성화하면 각 언어별로 다른 폰트를 적용할 수 있습니다:

- **영어**: 라틴 문자 (U+0020-007F, U+00A0-00FF, etc.)
- **한국어**: 한글 (U+1100-11FF, U+3130-318F, U+AC00-D7AF, etc.)
- **일본어**: 히라가나/가타카나 (U+3040-309F, U+30A0-30FF, etc.)
- **중국어**: 한자 (U+4E00-9FFF, U+3400-4DBF, etc.)

### 테마 연동

1. 테마 이름 입력
2. 연동할 프리셋 선택
3. "테마 연동 추가" 클릭

테마가 변경되면 자동으로 설정된 프리셋이 적용됩니다.

## 💬 슬래시 커맨드

### `/font`
폰트 관리 창을 엽니다.

```
/font
```

### `/font-debug`
디버깅 정보를 콘솔에 출력합니다.

```
/font-debug
```

## 📄 설정 파일

설정은 브라우저의 localStorage에 자동 저장됩니다:

- **키**: `font-manager-settings`
- **형식**: JSON
- **내용**: 폰트 목록, 프리셋, 테마 규칙 등

### 백업 및 복원

#### 📤 설정 내보내기 (v2.0)
1. "설정 내보내기" 버튼 클릭
2. 현재 선택된 프리셋 정보가 포함된 JSON 파일 자동 다운로드
3. 파일명 형식: `font-manager-settings-YYYYMMDD-HHMM.json`

#### 📥 설정 불러오기 (스마트 병합)
1. "설정 불러오기" 버튼 클릭
2. JSON 파일 선택
3. **자동 병합 처리**:
   - 폰트 목록: 이름 중복 제거하여 기존 폰트와 병합
   - 프리셋: 이름 중복 제거하여 기존 프리셋과 병합
   - 테마 연동: 테마 이름 중복 제거하여 기존 규칙과 병합
   - 현재 선택된 프리셋: v2.0 파일인 경우 자동으로 해당 프리셋 선택

#### 🔄 호환성
- **v2.0 형식**: 현재 선택된 프리셋 정보 포함
- **v1.0 형식**: 기존 백업 파일도 완벽 호환

## 🔧 문제 해결

### 폰트가 적용되지 않는 경우

1. **폰트 매니저 활성화 확인**
   - 설정에서 "폰트 매니저 활성화"가 체크되어 있는지 확인

2. **폰트 URL 확인**
   - 폰트 파일 URL이 유효한지 확인
   - CORS 정책으로 인해 일부 외부 폰트가 차단될 수 있음

3. **CSS 문법 확인**
   - @font-face 규칙이 올바른 CSS 문법인지 확인

4. **브라우저 캐시 삭제**
   - 브라우저 캐시를 삭제하고 페이지 새로고침

### 설정이 저장되지 않는 경우

1. **로컬 스토리지 확인**
   - 브라우저의 로컬 스토리지가 활성화되어 있는지 확인

2. **시크릿 모드 사용 금지**
   - 시크릿/인코그니토 모드에서는 설정이 저장되지 않음

### 설정 불러오기 문제

1. **파일 형식 확인**
   - JSON 파일인지 확인 (.json 확장자)
   - 파일 크기가 10MB 이하인지 확인

2. **병합 결과 확인**
   - 콘솔(F12)에서 병합 과정 로그 확인
   - 중복된 이름의 항목들은 자동으로 제외됨

3. **프리셋 자동 선택 안됨**
   - v1.0 형식 파일은 프리셋 자동 선택 기능 없음
   - v2.0 형식 파일만 현재 선택된 프리셋 정보 포함

### 성능 이슈

1. **과도한 폰트 사용 주의**
   - 너무 많은 폰트를 동시에 로드하면 성능 저하 가능

2. **폰트 파일 크기 확인**
   - 큰 폰트 파일은 로딩 시간이 길어질 수 있음

## 📊 파일 구조

```
Font-Manager/
├── README.md          # 이 파일
├── manifest.json      # 확장 메타데이터
├── index.js          # 메인 로직
├── style.css         # 스타일시트
├── template.html     # UI 템플릿
└── button.html       # 메뉴 버튼 템플릿
```

## 🎨 커스터마이징

### CSS 변수

확장에서 사용하는 주요 CSS 변수들:

```css
:root {
  --font-manager-ui-size: 14px;
  --font-manager-ui-weight: 0px;
  --font-manager-chat-size: 14px;
  --font-manager-input-size: 14px;
  --font-manager-chat-weight: 0px;
  --font-manager-chat-line-height: 1.2rem;
}
```

## 🤝 기여하기

프로젝트 개선을 위한 기여를 환영합니다!

1. 이슈 리포트
2. 기능 제안
3. 코드 기여
4. 문서 개선

## 📝 라이선스

이 프로젝트는 MIT 라이선스 하에 배포됩니다.

## 🙏 감사의 말

- SillyTavern 개발팀
- 오픈소스 폰트 제작자들
- 커뮤니티 기여자들

---

**Font Manager**로 더욱 개성 있는 채팅 환경을 만들어보세요! 🎨✨ 